<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category   design_blank
 * @package    Mage
 * @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license    http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * Ship to multiple address template
 *
 * @see Mage_Checkout_Block_Multishipping_Addresses
 */
?>
<?php echo $this->getMessagesBlock()->getGroupedHtml() ?>

<!--Sprungziel Tastatursteuerung -->
<div id="jumptarget<?php echo $this->getNameInLayout();?>"></div>

<div class="page-title title-buttons">
    <h1><?php echo $this->__('Enter New Address') ?></h1>
</div>
<form action="<?php echo $this->getPostActionUrl() ?>" method="post" id="form-validate">
    <input type="hidden" name="billing[address_id]" value="new" id="billing:address_id" />
<?php if (!$this->canShip()): ?>
    <input type="hidden" name="billing[use_for_shipping]" value="1" />
<?php endif; ?>
    <div>
        <div class="fieldset">
            <h2 class="legend"><?php echo $this->__('New Address') ?></h2>
            <ul class="form-list">
                <li class="fields">
                    <?php echo $this->getBillingtext()?>
                </li>
                <li class="fields">
                    <div class="field name-firstname">
                        <label for="prefix">
                            <?php echo $this->getFieldRequiredHtml('prefix')?>
                            <?php echo $this->__('Prefix') ?>
                        </label>
                    <?php if(count($this->getPrefixOptions())): ?>
                        <select tabindex="1" id="prefix" name="billing[prefix]" title="<?php echo $this->__('Prefix') ?>">
		    		            <?php foreach ($this->getPrefixOptions() as $_option): ?>
		    		                <option value="<?php echo $_option?>" <?php if ($this->getAddress()->getPrefix()==$_option) { echo 'selected="selected"'; } ?>><?php echo $this->__($_option)?></option>
		    		            <?php endforeach ?>
		    		            </select>
		    		        <?php else: ?>
		    		            <div class="input-box">
                            <input tabindex="1" type="text" id="billing:prefix" name="billing[prefix]" value="<?php echo $this->htmlEscape($this->getAddress()->getPrefix()) ?>" title="<?php echo $this->__('Prefix') ?>" class="input-text " maxlength="27" />
                        </div>
		    		        <?php endif; ?>
		    		        </div>
		    		    </li>

            <?php $_dob = $this->getLayout()->createBlock('customer/widget_dob') ?>
		    		<?php if ($_dob->isEnabled()): ?>
		    		    <li class="fields">
		    		        <?php echo $_dob->setDate($this->getQuote()->getCustomerDob())
		    		                        ->setFieldIdFormat('billing:%s')->setFieldNameFormat('billing[%s]')->toHtml() ?>
		    		    </li>
		    		<?php endif; ?>

		    		    <li class="fields">
		    		        <div class="field name-firstname">
		    		            <label for="firstname">
		    		                <?php echo $this->getFieldRequiredHtml('firstname')?>
		    		                <?php echo $this->__('First Name') ?>
		    		            </label>
		    		            <div class="input-box">
                            <input tabindex="2" type="text" id="billing:firstname" name="billing[firstname]" value="<?php echo $this->htmlEscape($this->getAddress()->getFirstname()) ?>" title="<?php echo $this->__('First Name') ?>" class="input-text " maxlength="27" />
                        </div>
                    </div>
                </li>
              <?php if(!$this->isCustomerLoggedIn() AND $this->isFieldVisible('email')):?>
                <li class="fields">
                    <div class="field validate-email ">
                        <label for="email">
                            <?php echo $this->getFieldRequiredHtml('email')?>
                            <?php echo $this->__('Email Address') ?>
                        </label>
                        <div class="input-box">
                            <input tabindex="4" type="text" id="billing:email" name="billing[email]" value="<?php echo $this->htmlEscape($this->getAddress()->getEmail()) ?>" title="<?php echo $this->__('Email Address') ?>" class="input-text required-entry" maxlength="64" />
                        </div>
                    </div>
                </li>
              <?php endif ?>
            </ul>
        </div>
        <div class="fieldset">
            <h2 class="legend">&nbsp;</h2>
            <ul class="form-list">
                <li class="fields dummy"></li>

		    		<?php $_taxvat = $this->getLayout()->createBlock('customer/widget_taxvat') ?>
		    		<?php if ($_taxvat->isEnabled()): ?>
		    		    <li class="fields">
		    		        <?php echo $_taxvat->setTaxvat($this->getQuote()->getCustomerTaxvat())
		    		                           ->setFieldIdFormat('billing:%s')->setFieldNameFormat('billing[%s]')->toHtml() ?>
		    		    </li>
		    		<?php endif ?>

                <li class="fields">
                    <div class="field name-lastname">
                        <label for="lastname">
                            <?php echo $this->getFieldRequiredHtml('lastname')?>
                            <?php echo $this->__('Last Name') ?>
                        </label>
                        <div class="input-box">
                            <input tabindex="3" type="text" id="billing:lastname" name="billing[lastname]" value="<?php echo $this->htmlEscape($this->getAddress()->getLastname()) ?>" title="<?php echo $this->__('Last Name') ?>" class="input-text" maxlength="27" />
                        </div>
                    </div>
              <?php if(!$this->isCustomerLoggedIn() AND $this->isFieldVisible('company')):?>
                <li class="fields">
                    <div class="field name-company">
                        <label for="company">
                            <?php echo $this->getFieldRequiredHtml('company')?>
                            <?php echo $this->__('Company') ?>
                        </label>
                        <div class="input-box">
                            <input tabindex="5" type="text" id="billing:company" name="billing[company]" value="<?php echo $this->htmlEscape($this->getAddress()->getCompany()) ?>" title="<?php echo $this->__('Company') ?>" class="input-text" maxlength="27" />
                        </div>
                    </div>
                  <?php if($this->isAdditionalCompanyVisible()):?>
                    <div class="field name-company">
                        <label for="company2">
                            <?php echo $this->getFieldRequiredHtml('company 2')?>
                            <?php echo $this->__('Company 2') ?>
                        </label>
                        <div class="input-box">
                            <input tabindex="5" type="text" id="billing:company2" name="billing[company2]" value="<?php echo $this->htmlEscape($this->getAddress()->getCompany2()) ?>" title="<?php echo $this->__('Company 2') ?>" class="input-text" maxlength="27" />
                        </div>
                    </div>
                    <div class="field name-company">
                        <label for="company3">
                            <?php echo $this->getFieldRequiredHtml('company 3')?>
                            <?php echo $this->__('Company 3') ?>
                        </label>
                        <div class="input-box">
                            <input tabindex="5" type="text" id="billing:company3" name="billing[company3]" value="<?php echo $this->htmlEscape($this->getAddress()->getCompany3()) ?>" title="<?php echo $this->__('Company 3') ?>" class="input-text" maxlength="27" />
                        </div>
                    </div>
                  <?php endif ?>
                </li>
              <?php endif ?>
                </li>
            </ul>
        </div>

        <div class="fieldset wide">
            <ul class="form-list">
              <?php if($this->isFieldVisible('street')):?>
                <li class="fields street-field">
                    <div class="field">
                        <label for="billing:street1">
                            <?php echo $this->getFieldRequiredHtml('street')?>
                            <?php echo $this->__('Street Address') ?>
                        </label>
	                      <input tabindex="6" type="text" title="<?php echo $this->__('Street Address') ?>" name="billing[street][]" id="billing:street1" value="<?php echo $this->htmlEscape($this->getAddress()->getStreet(1)) ?>" class="input-text required-entry" maxlength="22" />
                    <?php for ($_i=1, $_n=$this->helper('customer/address')->getStreetLines(); $_i<=$_n; $_i++): ?>
		    		            <input tabindex="6" type="text" title="<?php echo $this->__('Street Address '.$_i) ?>" name="billing[street][]" id="billing:street<?php echo $_i?>" value="<?php echo $this->htmlEscape($this->getAddress()->getStreet($_i+1)) ?>" class="input-text" maxlength="21" />
		                <?php endfor ?>
                    </div>
		    		    </li>
              <?php endif ?>
            </ul>
        </div>

        <div class="fieldset">
            <ul class="form-list">
      		    <?php if($this->isFieldVisible('postcode')):?>
		    		    <li class="fields">
		    		        <div class="field">
		    		            <label for="billing:postcode">
		    		                <?php echo $this->getFieldRequiredHtml('postcode')?>
		    		                <?php echo $this->__('Zip/Postal Code') ?>
		    		            </label>
		    		            <input tabindex="7" type="text" title="<?php echo $this->__('Zip/Postal Code') ?>" name="billing[postcode]" id="billing:postcode" value="<?php echo $this->htmlEscape($this->getAddress()->getPostcode()) ?>" class="input-text validate-zip-international required-entry" maxlength="10" />
		    		        </div>
		    		    </li>
	    		    <?php endif ?>
		    		  <?php if($this->isFieldVisible('region')):?>
		    		    <li class="fields">
		    		        <div class="field" id="block-region">
		    		            <label for="billing:region">
		    		                <?php echo $this->getFieldRequiredHtml('region')?>
		    		                <?php echo $this->__('State/Province') ?>
		    		            </label>
		    		            <?php echo $this->getRegionHtmlSelect('billing') ?>
		    		        </div>
		    		    </li>
		    		  <?php endif ?>
              <?php if($this->isFieldVisible('telephone')):?>
                <li class="fields">
                    <div class="field">
                        <label for="billing:telephone">
                            <?php echo $this->getFieldRequiredHtml('telephone')?>
                            <?php echo $this->__('Telephone') ?>
                        </label>
                        <input tabindex="13" type="text" name="billing[telephone]" value="<?php echo $this->htmlEscape($this->getAddress()->getTelephone()) ?>" title="<?php echo $this->__('Telephone') ?>" class="input-text required-entry" id="billing:telephone" maxlength="32" />
                    </div>
                </li>
              <?php endif ?>
            <?php if(!$this->isCustomerLoggedIn()): ?>
              <?php if (!$this->isGuest()): ?>
                <?php if (!$this->isGuest()): ?>
                <li class="fields" id="register-customer-password">
		    		        <div class="field">
		    		            <!-- Autocomplete-Bug von Firefox verhindern -> sonst wird ZIP als Username verwendet. -->
		    		            <input type="text" name="username" value="-" style="display: none"/>
		    		            <label for="billing:customer_password">
		    		                <span class="required">*</span>
		    		                <?php echo $this->__('Password') ?>
		    		            </label>
		    		            <input tabindex="15" type="password" name="billing[customer_password]" id="billing:customer_password" title="<?php echo $this->__('Password') ?>" class="input-text required-entry validate-password" autocomplete="off" />
		    		        </div>
		    		    </li>
                <?php endif ?>
              <?php endif ?>
            <?php endif ?>
            </ul>
        </div>
        <div class="fieldset">
            <ul class="form-list">
		    		  <?php if($this->isFieldVisible('city')):?>
		    		    <li class="fields">
		    		        <div class="field">
		    		            <label for="billing:city">
		    		                <?php echo $this->getFieldRequiredHtml('city')?>
		    		                <?php echo $this->__('City') ?>
		    		            </label>
		    		            <input tabindex="8" type="text" title="<?php echo $this->__('City') ?>" name="billing[city]" value="<?php echo $this->htmlEscape($this->getAddress()->getCity()) ?>" class="input-text required-entry" id="billing:city" maxlength="22" />
		    		        </div>
		    		    </li>
		    		  <?php endif ?>
		    		  <?php if($this->isFieldVisible('country_id')):?>
		    		    <li class="fields">
		    		        <div id="block-country" class="field">
		    		            <label for="billing:country_id">
		    		                <?php echo $this->getFieldRequiredHtml('country_id')?>
		    		                <?php echo $this->__('Country') ?>
		    		            </label>
		    		            <?php echo $this->getCountryHtmlSelect('billing') ?>
		    		        </div>
		    		    </li>
		    		  <?php endif ?>
              <?php if($this->isFieldVisible('fax')):?>
                <li class="fields">
                    <div class="field">
                        <label for="billing:fax">
                            <?php echo $this->getFieldRequiredHtml('fax')?>
                            <?php echo $this->__('Fax') ?>
                        </label>
                        <input tabindex="14" type="text" name="billing[fax]" value="<?php echo $this->htmlEscape($this->getAddress()->getFax()) ?>" title="<?php echo $this->__('Fax') ?>" class="input-text" id="billing:fax" maxlength="32" />
                    </div>
                </li>
              <?php endif ?>
            <?php if(!$this->isCustomerLoggedIn()): ?>
              <?php if (!$this->isGuest()): ?>
                <?php if (!$this->isGuest()): ?>
                <li class="fields" id="register-customer-password">
		    		        <div class="field">
		    		            <label for="billing:confirm_password">
		    		                <span class="required">*</span>
		    		                <?php echo $this->__('Confirm Password') ?>
		    		            </label>
	                      <input tabindex="16" type="password" name="billing[confirm_password]" title="<?php echo $this->__('Confirm Password') ?>" id="billing:confirm_password" class="input-text required-entry validate-cpassword" autocomplete="off" />
		    		        </div>
		    		    </li>
                <?php endif ?>
              <?php endif ?>
            <?php endif ?>
            </ul>
        </div>

        <div class="fieldset wide">
            <ul class="form-list">
		    		  <?php if ($this->canShip()): ?>
		    		    <li class="fields" id="new-address-use-for-shipping">
		    		        <div class="field">
		    		            <input tabindex="17" type="radio" name="billing[use_for_shipping]" id="billing:use_for_shipping_yes" value="1"<?php if ($this->isUseBillingAddressForShipping()) {?> checked="checked"<?php }?> class="radio" />
		    		            <label for="billing:use_for_shipping_yes">
		    		                <?php echo  $this->__('Ship to this address') ?>
		    		            </label>
		    		        </div>
		    		    </li>
		    		    <li class="fields" id="new-address-use-for-shipping-no">
		    		        <div class="field">
		    		            <input tabindex="18" type="radio" name="billing[use_for_shipping]" id="billing:use_for_shipping_no" value="0"<?php if (!$this->isUseBillingAddressForShipping()) {?> checked="checked"<?php }?> class="radio" />
		    		            <label for="billing:use_for_shipping_no">
		    		                <?php echo $this->__('Ship to different address') ?>
		    		            </label>
		    		        </div>
		    		    </li>
  	            <?php if($this->isStorePickupAvailable()):?>
		    		    <li class="fields" id="new-address-use-for-shipping-option">
		    		        <div class="field">
		    		            <input tabindex="19" type="radio" name="billing[use_for_shipping]" id="billing:use_for_shipping_option" value="2"<?php if ($this->isStorePickup()) {?> checked="checked"<?php }?>  class="radio" />
		    		            <label for="billing:use_for_shipping_option">
		    		                <?php echo $this->__('Store Pickup') ?>
		    		            </label>
		    		        </div>
		    		    </li>
		    		    <?php endif; ?>
		    		  <?php endif; ?>

		    		  <?php if ($this->isCustomerLoggedIn() && $this->customerHasAddresses()):?>
		    		    <li class="fields">
		    		        <div class="field">
		    		            <input tabindex="20" type="checkbox" name="billing[save_in_address_book]" value="1" title="<?php echo $this->__('Save in address book') ?>" id="billing:save_in_address_book" onchange="shipping.setSameAsBilling(false);"<?php if ($this->getAddress()->getSaveInAddressBook()):?> checked="checked"<?php endif;?> class="checkbox" />
		    		            <input type="hidden" name="billing[save_in_address_book]" value="1" />
		    		            <label for="billing:save_in_address_book">
		    		                <?php echo $this->__('Save in address book') ?>
		    		            </label>
		    		        </div>
		    		    </li>
		    		  <?php endif ?>

            </ul>
        </div>

    </div>

    <p class="required"><?php echo $this->__('* Required Fields') ?></p>

    <div class="buttons-set">
        <a class="back-link egovslistbutton" href="<?php echo $this->getBackUrl() ?>" tabindex="21">
            <span><?php echo $this->__('Back') ?></span>
        </a>
        <a class="break-link egovslistbutton" href="<?php echo $this->getUrl() ?>" tabindex="22">
            <span><?php echo $this->__('Continue Shopping') ?></span>
        </a>
        <button  class="button" type="submit" tabindex="23">
            <span><?php echo $this->__('Continue') ?></span>
        </button>
    </div>

</form>

<script type="text/javascript">
//<![CDATA[
    var billingForm = new VarienForm('co-billing-form');

    $j('#block-region select').attr("tabindex","11");
    $j('#block-country select').attr("tabindex","12");
//]]>
</script>