<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category   design_blank
 * @package    Mage
 * @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license    http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * Multishipping checkout shipping template
 *
 * @see Mage_Checkout_Block_Multishipping_Shipping
 */
?>
<div class="page-title">
    <h2><?php echo $this->__('Please select your shipping address') ?></h2>
</div>
<?php echo $this->getMessagesBlock()->getGroupedHtml() ?>
<form action="<?php echo $this->getPostActionUrl() ?>" method="post" id="shipping_method_form">
	<?php echo $this->getBlockHtml('formkey'); ?>
    <input type="hidden" name="shipping[address_id]" value="new" id="shipping:address_id" />
    <input type="hidden" name="method" value="shipping" />
    <div>
        <div class="fieldset wide">
            <ul class="form-list">
                <li class="fields fullwide">
                    <?php echo $this->getLayout()->createBlock('egovsbase/customer_widget_name')
                                    ->setMethod('shippingrequired')
                                    ->setObject($this->getAddress())
                                    ->setFieldIdFormat('shipping:%s')->setFieldNameFormat('shipping[%s]')
                                    ->setFieldParams('onchange="shipping.setSameAsBilling(false)"')->toHtml();
                    ?>
                </li>
            </ul>
        </div>

        <div class="fieldset">
            <ul class="form-list">
              <?php if($this->isFieldVisible('company')):?>
                <li class="fields">
                    <div class="input-box">
                        <label for="shipping:company">
                            <?php echo $this->getFieldRequiredHtml('company', 'shipping')?>
                            <?php echo $this->__('Company') ?>
                        </label>
                        <input tabindex="4" type="text" id="shipping:company" name="shipping[company]" value="<?php echo $this->htmlEscape($this->getAddress()->getCompany()) ?>" title="<?php echo $this->__('Company') ?>" class="input-text" onchange="shipping.setSameAsBilling(false);" />
                    </div>
                </li>
              <?php endif ?>

             	<?php if($this->isFieldVisible('telephone')):?>
                <li class="fields">
                    <div class="input-box">
                        <label for="shipping:telephone">
                            <?php echo $this->getFieldRequiredHtml('telephone', 'shipping')?>
                            <?php echo $this->__('Telephone') ?>
                        </label>
                        <input tabindex="6" type="text" name="shipping[telephone]" value="<?php echo $this->htmlEscape($this->getAddress()->getTelephone()) ?>" title="<?php echo $this->__('Telephone') ?>" class="input-text required-entry" id="shipping:telephone" onchange="shipping.setSameAsBilling(false);" />
                    </div>
                </li>
              <?php endif?>

              <?php if(false): ?>
                <li class="fields">
                    <div class="input-box">
                        <label for="shipping:email">
                            <span class="required">*</span>
                            <?php echo $this->__('Email Address') ?>
                        </label>
                        <input tabindex="8" type="text" name="shipping[email]" id="shipping:email" value="<?php echo $this->htmlEscape($this->getAddress()->getEmail()) ?>" title="<?php echo $this->__('Email Address') ?>" class="input-text validate-email required-entry" />
                    </div>
                </li>
              <?php endif ?>
            </ul>
        </div>
        <div class="fieldset">
            <ul class="form-list">
              <?php if($this->isFieldVisible('company')):?>
                <li class="fields">
                    <div class="input-box">
                        <label for="shipping:taxvat">
                            <?php echo $this->getFieldRequiredHtml('taxvat', 'shipping')?>
                            <?php echo $this->__('Taxvat') ?>
                        </label>
                        <input tabindex="5" type="text" id="shipping:taxvat" name="shipping[taxvat]" value="<?php echo $this->htmlEscape($this->getAddress()->getTaxvat()) ?>" title="<?php echo $this->__('Taxvat') ?>" class="input-text" onchange="shipping.setSameAsBilling(false);" />
                    </div>
                </li>
              <?php endif ?>

              <?php if($this->isFieldVisible('fax')):?>
                <li class="fields">
                    <div class="input-box">
                        <label for="shipping:fax">
                            <?php echo $this->getFieldRequiredHtml('fax', 'shipping')?>
                            <?php echo $this->__('Fax') ?>
                        </label>
                        <input tabindex="7" type="text" name="shipping[fax]" value="<?php echo $this->htmlEscape($this->getAddress()->getFax()) ?>" title="<?php echo $this->__('Fax') ?>" class="input-text" id="shipping:fax" onchange="shipping.setSameAsBilling(false);" />
                    </div>
                </li>
              <?php endif ?>

            </ul>
        </div>

        <div class="fieldset wide">
            <ul class="form-list">
              <?php if($this->isFieldVisible('street')):?>
                <li class="fields street-field">
                    <div class="field">
                        <label for="billing:street1">
                            <?php echo $this->getFieldRequiredHtml('street', 'shipping')?>
                            <?php echo $this->__('Street Address') ?>
                        </label>
	                      <input tabindex="9" type="text" title="<?php echo $this->__('Street Address') ?>" name="shipping[street][]" id="shipping:street1" value="<?php echo $this->htmlEscape($this->getAddress()->getStreet(1)) ?>" class="input-text required-entry" maxlength="22" />
                    <?php for ($_i=2, $_n=$this->helper('customer/address')->getStreetLines(); $_i<=$_n; $_i++): ?>
		    		            <input tabindex="10" type="text" title="<?php echo $this->__('Street Address '.$_i) ?>" name="shipping[street][]" id="shipping:street<?php echo $_i?>" value="<?php echo $this->htmlEscape($this->getAddress()->getStreet($_i+1)) ?>" class="input-text" maxlength="21" />
		                <?php endfor ?>
                    </div>
		    		    </li>
              <?php endif ?>
            </ul>
        </div>

        <div class="fieldset">
            <ul class="form-list">
                <li class="fields">
                    <div class="input-box">
                        <label for="shipping:postcode">
                            <?php echo $this->getFieldRequiredHtml('postcode', 'shipping')?>
                            <?php echo $this->__('Zip/Postal Code') ?>
                        </label>
                        <input tabindex="11" type="text" title="<?php echo $this->__('Zip/Postal Code') ?>" name="shipping[postcode]" id="shipping:postcode" value="<?php echo $this->htmlEscape($this->getAddress()->getPostcode()) ?>" class="input-text validate-zip-international required-entry" onchange="shipping.setSameAsBilling(false);" />
                    </div>
                </li>
                <li class="fields">
                    <div class="input-box" id="block-region">
                        <label for="shipping:region">
                            <?php echo $this->getFieldRequiredHtml('region', 'shipping')?>
                            <?php echo $this->__('State/Province') ?>
                        </label>
                        <?php echo $this->getRegionHtmlSelect('shipping') ?>
                    </div>
                </li>
            </ul>
        </div>
        <div class="fieldset">
            <ul class="form-list">
                <li class="fields">
                    <div class="input-box">
                        <label for="shipping:city">
                            <?php echo $this->getFieldRequiredHtml('city', 'shipping')?>
                            <?php echo $this->__('City') ?>
                        </label>
                        <input tabindex="12" type="text" title="<?php echo $this->__('City') ?>" name="shipping[city]" value="<?php echo $this->htmlEscape($this->getAddress()->getCity()) ?>" class="input-text required-entry" id="shipping:city" onchange="shipping.setSameAsBilling(false);" />
                    </div>
                </li>
                <li class="fields">
                    <div class="input-box" id="block-country">
                        <label for="shipping:country_id">
                            <?php echo $this->getFieldRequiredHtml('country_id', 'shipping')?>
                            <?php echo $this->__('Country') ?>
                        </label>
                        <?php echo $this->getCountryHtmlSelect('shipping') ?>
                    </div>
                </li>
            </ul>
        </div>

        <div class="fieldset wide">
            <ul class="form-list">
              <?php if ($this->isCustomerLoggedIn() && $this->customerHasAddresses()):?>
                <li class="fields">
                    <input tabindex="15" type="checkbox" name="shipping[save_in_address_book]" value="1" title="<?php echo $this->__('Save in address book') ?>" id="shipping:save_in_address_book" onchange="shipping.setSameAsBilling(false);"<?php if ($this->getAddress()->getSaveInAddressBook()):?> checked="checked"<?php endif;?> class="checkbox" />
                    <label for="shipping:save_in_address_book"><?php echo $this->__('Save in address book') ?></label>
                </li>
              <?php else:?>
                <li class="no-display">
                    <input type="hidden" name="shipping[save_in_address_book]" value="1" />
                </li>
              <?php endif;?>
            </ul>
        </div>
    </div>

    <p class="required"><?php echo $this->__('* Required Fields') ?></p>

    <div class="buttons-set">
        <a class="button" href="<?php echo $this->getBackUrl() ?>" tabindex="16">
            <?php echo $this->__('Back') ?>
        </a>
        <a class="button" href="<?php echo $this->getUrl() ?>" tabindex="17">
            <?php echo $this->__('Continue Shopping') ?>
        </a>
        <button  class="button" type="submit" tabindex="18">
            <span><?php echo $this->__('Continue') ?></span>
        </button>
    </div>
</form>

<script type="text/javascript">
//<![CDATA[
    $j('.name-firstname input').attr('tabindex','1');
    $j('.name-middlename input').attr('tabindex','2');
    $j('.name-lastname input').attr('tabindex','3');

    $j('#block-region select').attr("tabindex","13");
    $j('#block-country select').attr("tabindex","14");
//]]>
</script>